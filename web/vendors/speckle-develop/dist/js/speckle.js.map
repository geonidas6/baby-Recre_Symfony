{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/speckle.js"],"names":[],"mappings":"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","file":"speckle.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()","/**\r\n * Speckle.js\r\n *\r\n * A JavaScript module that adds responsive, stylized \r\n * speckles to any element; with no dependencies.\r\n *\r\n * @package speckle\r\n * @since   0.0.1\r\n */\r\nclass Speckle {\r\n\r\n\t/**\r\n\t * Constructor.\r\n\t *\r\n\t * @since  0.0.1\r\n\t * @param  {Element}  element  The passed element to speckle.\r\n\t * @param  {obj}      options  The options object.\r\n\t * @return {void} \r\n\t */\r\n\tconstructor(element, options) {\r\n\t\t// keep track of this instance number for use in \r\n\t\t// grouping the speckles, and the `destroy()` method.\r\n\t\tthis.instance = Speckle.instance;\r\n\t\t// augment the instance count on the class, not the instance.\r\n\t\tSpeckle.instance++;\r\n\t\t// throw error if `element` is not a valid HTML element.\r\n\t\tif (! element || ! (element instanceof Element)) {\r\n\t\t\tthis.throwElementError();\r\n\t\t}\r\n\t\tthis.element = element;\r\n\t\t// Set the default options.\r\n\t\tthis.defaultOptions = {\r\n\t\t\tquantity: 56, // quantity of speckles\r\n\t\t\tminSize: 4, // smallest speckle (1+, less than `maxSize`, px)\r\n\t\t\tmaxSize: 56, // largest speckle (1+, greater than `minSize`, px)\r\n\t\t\ttbOffset: 8, // top/bottom offset (0+, %)\r\n\t\t\tlrOffset: 8,  // left/right offset (0+, %)\r\n\t\t\tminOpacity: 12.5, // minimum opacity (1-100)\r\n\t\t\tmaxOpacity: 87.5, // maximum opacity (1-100)\r\n\t\t\tisBokeh: false, // bokeh effect (blur as a factor of distance)\r\n\t\t\tcolor: '', // color (hex, rgb, hsl, keyword). If none, the colors will be randomized.\r\n\t\t\tzIndex: 0, // z-index (bokeh: the starting z-index)\r\n\t\t\tisCropped: false, // apply `overflow: hidden;` to the container\r\n\t\t\ttagName: 'I', // the Tag Name that the speckle should be rendered as\r\n\t\t\tattributes: null // attributes object as `key: value` pairs\r\n\t\t};\r\n\t\t// Parse and set options.\r\n\t\tthis.options = this.parseOptions(options, this.defaultOptions);\r\n\t\tconst { minSize, maxSize, tbOffset, lrOffset, minOpacity, maxOpacity } = this.options;\r\n\t\t// throw error if `minSize` is less than 1, or greater than `maxSize`.\r\n\t\tif ((minSize < 1) || (minSize > maxSize)) {\r\n\t\t\tthis.throwOptionsError('minSize');\r\n\t\t}\r\n\t\t// throw error if `maxSize` is less than 1, or less than `minSize`.\r\n\t\tif ((maxSize < 1) || (maxSize < minSize)) {\r\n\t\t\tthis.throwOptionsError('maxSize');\r\n\t\t}\r\n\t\t// throw error if `tbOffset` is less than 0.\r\n\t\tif (tbOffset < 0) {\r\n\t\t\tthis.throwOptionsError('tbOffset');\r\n\t\t}\r\n\t\t// throw error if `lrOffset` is less than 0.\r\n\t\tif (lrOffset < 0) {\r\n\t\t\tthis.throwOptionsError('lrOffset');\r\n\t\t}\r\n\t\t// throw error if `minOpacity` is less than 0 or greater than 100; or if is greater than `maxOpacity`.\r\n\t\tif ((minOpacity < 0) || (minOpacity > 100) || (minOpacity > maxOpacity)) {\r\n\t\t\tthis.throwOptionsError('minOpacity');\r\n\t\t}\r\n\t\t// throw error if `maxOpacity` is less than 0 or greater than 100; or if is less than `minOpacity`.\r\n\t\tif ((maxOpacity < 0) || (maxOpacity > 100) || (maxOpacity < minOpacity)) {\r\n\t\t\tthis.throwOptionsError('maxOpacity');\r\n\t\t}\r\n\t\t// Set the global styles.\r\n\t\tthis.globalStyles = {\r\n\t\t\tborderRadius: '50%', \r\n\t\t\tdisplay: 'block', \r\n\t\t\tpointerEvents: 'none', \r\n\t\t\tposition: 'absolute', \r\n\t\t};\r\n\t\t// Set the upgraded class.\r\n\t\tthis.upgradedClass = 'speckle--upgraded';\r\n\t\t// Render speckles.\r\n\t\tthis.render();\r\n\t}\r\n\r\n\t/**\r\n\t * Parse the passed options against the defaults.\r\n\t * \r\n\t * @param  {obj}  options         The passed in user options object.\r\n\t * @param  {obj}  defaultOptions  The default options object.\r\n\t * @return {obj}                  The parsed options object.\r\n\t */\r\n\tparseOptions(options, defaultOptions) {\r\n\t\t// if no options are passed, just return the default options.\r\n\t\tif (! options || typeof options !== 'object') {\r\n\t\t\treturn defaultOptions;\r\n\t\t}\r\n\t\t// init empty `parsedOptions` object.\r\n\t\tvar parsedOptions = {};\r\n\t\t// loop default option keys and parse. If the options \r\n\t\t// object has this key, use it; else, use the default option.\r\n\t\tfor (var key in defaultOptions) {\r\n\t\t\tconst value = options[key];\r\n\t\t\t// If the value is a number, set it no matter what.\r\n\t\t\t// This prevents issues where passing `0` is read as \r\n\t\t\t// no option passed, rendering the default instead.\r\n\t\t\tif (typeof value === 'number') {\r\n\t\t\t\tparsedOptions[key] = value;\r\n\t\t\t} else {\r\n\t\t\t\tparsedOptions[key] = value || defaultOptions[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t// return the parsed options.\r\n\t\treturn parsedOptions;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Throw an element error.\r\n\t * \r\n\t * @since  0.0.1\r\n\t * @return {Error}  The formatted element error.\r\n\t */\r\n\tthrowElementError() {\r\n\t\tthrow new Error(\r\n\t\t\t'Speckle.js\\n' + \r\n\t\t\t'A valid HTML Element must be passed to the constructor as the first argument.'\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Throw an element error.\r\n\t * \r\n\t * @since  0.0.1\r\n\t * @return {Error}  The formatted element error.\r\n\t */\r\n\tthrowOptionsError(key) {\r\n\t\tvar message = '';\r\n\t\tif (key === 'minSize') {\r\n\t\t\tmessage = 'The value must be greater than or equal to 1, and less than `maxSize`.';\r\n\t\t} else if (key === 'maxSize') {\r\n\t\t\tmessage = 'The value must be greater than or equal to 1, and greater than `minSize`.';\r\n\t\t} else if (key === 'tbOffset') {\r\n\t\t\tmessage = 'The value must be greater than 0.';\r\n\t\t} else if (key === 'lrOffset') {\r\n\t\t\tmessage = 'The value must be greater than 0.';\r\n\t\t} else if (key === 'minOpacity') {\r\n\t\t\tmessage = 'The value must be between 1 and 100, and less than `maxOpacity`.';\r\n\t\t} else if (key === 'maxOpacity') {\r\n\t\t\tmessage = 'The value must be between 1 and 100, and greater than `minOpacity`.';\r\n\t\t}\r\n\t\tthrow new Error(\r\n\t\t\t`Speckle.js [${key}]\\n` + message\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Get a random integer between a passed minimum and maximum.\r\n\t * \r\n\t * @since  0.0.1\r\n\t * @param  {int}  min  The minimum for the returned integer.\r\n\t * @param  {int}  max  The maximum for the returned integer.\r\n\t * @return {int}       The randomized integer.\r\n\t */\r\n\tgetRandomInt(min, max) {\r\n\t\treturn Math.floor(Math.random() * ((max - min) + 1) + min);\r\n\t}\r\n\r\n\t/**\r\n\t * Get a random hex color.\r\n\t * \r\n\t * @since  0.0.1\r\n\t * @return {string}  A random hex color.\r\n\t */\r\n\tgetRandomHex() {\r\n\t\treturn `#${('000000' + Math.random().toString(16).slice(2, 8)).slice(-6).toUpperCase()}`;\r\n\t}\r\n\r\n\tgetStyles() {\r\n\t\tconst { globalStyles, options } = this;\r\n\t\tconst { minSize, maxSize, tbOffset, lrOffset, minOpacity, maxOpacity, color, isBokeh, zIndex } = options;\r\n\t\t// size\r\n\t\tconst size = this.getRandomInt(minSize, maxSize);\r\n\t\tconst center = (size / 2);\r\n\t\t// color\r\n\t\tconst renderColor = color || this.getRandomHex();\r\n\t\t// Create the styles object.\r\n\t\treturn Object.assign(globalStyles, {\r\n\t\t\tbackgroundColor: renderColor, \r\n\t\t\tboxShadow: isBokeh ? `0 0 ${(size / 3)}px ${(size / 3)}px ${renderColor}` : '', \r\n\t\t\theight: `${size}px`, \r\n\t\t\tleft: `calc(${this.getRandomInt(0 - lrOffset, 100 + lrOffset)}% - ${center}px)`, \r\n\t\t\topacity: (this.getRandomInt(minOpacity, maxOpacity) * 0.01), \r\n\t\t\ttop: `calc(${this.getRandomInt(0 - tbOffset, 100 + tbOffset)}% - ${center}px)`, \r\n\t\t\twidth: `${size}px`, \r\n\t\t\tzIndex: zIndex, \r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Destroy Speckle.\r\n\t * \r\n\t * @return {void} \r\n\t */\r\n\tdestroy() {\r\n\t\tconst { element, instance, upgradedClass } = this;\r\n\t\t// destroy the speckles related to this instance.\r\n\t\tconst speckles = element.querySelectorAll(`[data-speckle-group=\"${instance}\"]`);\r\n\t\tif (speckles && (speckles.length > 0)) {\r\n\t\t\tspeckles.forEach((speckle, i) => {\r\n\t\t\t\telement.removeChild(speckle);\r\n\t\t\t});\r\n\t\t}\r\n\t\t// remove this instance from the `data-speckle-groups` \r\n\t\t// attribute on the container element. If none are left after\r\n\t\t// removal, remove the attribute alltogether.\r\n\t\tconst groups = element.getAttribute('data-speckle-groups') || '';\r\n\t\t// initialize the `cleanElement` var as false.\r\n\t\tlet cleanElement = false;\r\n\t\tif (groups) {\r\n\t\t\t// split the groups value by `,` and explode into an array.\r\n\t\t\tlet newGroups = groups.split(',');\r\n\t\t\t// Using `splice()`, remove the index of this instance from\r\n\t\t\t// the `newGroups` array. Note: this returns the removed node, \r\n\t\t\t// not the new array.\r\n\t\t\tnewGroups.splice(newGroups.indexOf(instance.toString()), 1);\r\n\t\t\t// if there are any groups left after the removal, \r\n\t\t\t// set the `data-speckle-groups` attribute to the \r\n\t\t\t// new items as CSV. If there are no items left, remove \r\n\t\t\t// the attribute and set `cleanElement` to `true`.\r\n\t\t\tif (newGroups.length > 0) {\r\n\t\t\t\telement.setAttribute('data-speckle-groups', newGroups.join(','));\r\n\t\t\t} else {\r\n\t\t\t\telement.removeAttribute('data-speckle-groups');\r\n\t\t\t\tcleanElement = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// fully clean the container element, but only if no speckle \r\n\t\t// groups are left on the container element by this point.\r\n\t\tif (cleanElement) {\r\n\t\t\t// if the CSS `position` of the container element was modified\r\n\t\t\t// by this class, it will have added a `data-speckle-position-mod` \r\n\t\t\t// attribute set to `true` or the element's explicit CSS `position` \r\n\t\t\t// value if there was one on the element itself prior to the \r\n\t\t\t// first initialization.\r\n\t\t\tconst positionMod = element.getAttribute('data-speckle-position-mod');\r\n\t\t\tif (positionMod) {\r\n\t\t\t\telement.style.position = (positionMod === 'true') ? null : positionMod;\r\n\t\t\t\telement.removeAttribute('data-speckle-position-mod');\r\n\t\t\t}\r\n\t\t\t// remove the upgraded class.\r\n\t\t\telement.classList.remove(upgradedClass);\r\n\t\t\t// Remove the overflow mod. if the CSS `overflow` of the container \r\n\t\t\t// element was modified by this class, it will have added a \r\n\t\t\t// `data-speckle-overflow-mod` attribute set to `true` or the \r\n\t\t\t// element's explicit CSS `overflow` value if there was one \r\n\t\t\t// on the element itself prior to the first initialization.\r\n\t\t\tconst overflowMod = element.getAttribute('data-speckle-overflow-mod');\r\n\t\t\tif (overflowMod) {\r\n\t\t\t\telement.style.overflow = (overflowMod === 'true') ? null : overflowMod;\r\n\t\t\t\telement.removeAttribute('data-speckle-overflow-mod');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Destroy and rerender the speckles according\r\n\t * to the same options. Simply runs the `destroy()`\r\n\t * method followed by the `render()` method again.\r\n\t * \r\n\t * @return {void} \r\n\t */\r\n\trerender() {\r\n\t\tthis.destroy();\r\n\t\tthis.render();\r\n\t}\r\n\r\n\t/**\r\n\t * Render the speckles.\r\n\t * \r\n\t * @since  0.0.1\r\n\t * @param  {Element}  element  The container element to speckle.\r\n\t * @return {void} \r\n\t */\r\n\trender() {\r\n\t\tconst { element, instance, options, upgradedClass } = this;\r\n\t\tconst { quantity, isCropped, tagName, attributes } = options;\r\n\t\tconst { position, overflow } = window.getComputedStyle(element);\r\n\t\tconst isUpgraded = element.classList.contains(upgradedClass);\r\n\t\t// Set the instance of this class as `data-speckle-group` \r\n\t\t// incase it needs to be accessed by other scripts. Get the value \r\n\t\t// and append rather than overwriting as this value can be a CSV \r\n\t\t// list of speckle groups.\r\n\t\tconst oldGroups = element.getAttribute('data-speckle-groups') || '';\r\n\t\tconst newGroups = oldGroups ? [oldGroups, instance].join(',') : instance;\r\n\t\telement.setAttribute('data-speckle-groups', newGroups);\r\n\t\t// only add relative positioning to the container element if \r\n\t\t// it is not already `relative`, `fixed`, or `absolute`.\r\n\t\tif (! isUpgraded && (['relative, absolute, fixed'].indexOf(position) === -1)) {\r\n\t\t\t// on the container element, save the fact that the CSS `position` has \r\n\t\t\t// been modified as a `data-speckle-position-mod` attribute set to `true` \r\n\t\t\t// or the explicit `position` value if there is one.\r\n\t\t\telement.setAttribute('data-speckle-position-mod', element.style.position || true);\r\n\t\t\t// set the CSS `position`value to `relative` so that the speckles \r\n\t\t\t// (which are positioned absolute) know where to live.\r\n\t\t\telement.style.position = 'relative';\r\n\t\t}\r\n\t\t// Add `overflow: hidden;` to element if `isCropped` is `true`, if\r\n\t\t// overflows are not already hidden on the container element.\r\n\t\tif (! isUpgraded && isCropped && (['hidden'].indexOf(overflow) === -1)) {\r\n\t\t\telement.setAttribute('data-speckle-overflow-mod', element.style.overflow || true);\r\n\t\t\telement.style.overflow = 'hidden';\r\n\t\t}\r\n\t\t// render speckles according to quantity.\r\n\t\tfor (var i = 1; i <= quantity; i++) {\r\n\t\t\t// Create speckle element according to the `tagName` option.\r\n\t\t\tconst speckle = document.createElement(tagName);\r\n\t\t\t// Set the index of this speckle as `data-speckle-index` \r\n\t\t\t// incase it needs to be accessed by other scripts.\r\n\t\t\tspeckle.setAttribute('data-speckle-index', i);\r\n\t\t\t// Set the speckle group as `data-speckle-group` attribute\r\n\t\t\t// incase it needs to be accessed by other scripts, and\r\n\t\t\t// for use in the `destroy()` method.\r\n\t\t\tspeckle.setAttribute('data-speckle-group', instance);\r\n\t\t\t// Get speckle styles.\r\n\t\t\tconst styles = this.getStyles();\r\n\t\t\t// loop over the speckle style object keys and apply the styles.\r\n\t\t\tif (styles && typeof styles === 'object') {\r\n\t\t\t\tfor (var styleKey in styles) {\r\n\t\t\t\t\tspeckle.style[styleKey] = styles[styleKey];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Add the custom attributes to the speckle.\r\n\t\t\tif (attributes && typeof attributes === 'object') {\r\n\t\t\t\tfor (var attributeKey in attributes) {\r\n\t\t\t\t\tspeckle.setAttribute(attributeKey, attributes[attributeKey]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Append the speckle to the container element.\r\n\t\t\telement.appendChild(speckle);\r\n\t\t}\r\n\t\t// add the upgraded class.\r\n\t\tif (! isUpgraded) {\r\n\t\t\telement.classList.add(upgradedClass);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nSpeckle.instance = 1;\r\n\r\nexport default Speckle;"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvc3BlY2tsZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7SUFTTSxPOztBQUVMOzs7Ozs7OztBQVFBLGtCQUFZLE9BQVosRUFBcUIsT0FBckIsRUFBOEI7QUFBQTs7QUFDN0I7QUFDQTtBQUNBLE9BQUssUUFBTCxHQUFnQixRQUFRLFFBQXhCO0FBQ0E7QUFDQSxVQUFRLFFBQVI7QUFDQTtBQUNBLE1BQUksQ0FBRSxPQUFGLElBQWEsRUFBRyxtQkFBbUIsT0FBdEIsQ0FBakIsRUFBaUQ7QUFDaEQsUUFBSyxpQkFBTDtBQUNBO0FBQ0QsT0FBSyxPQUFMLEdBQWUsT0FBZjtBQUNBO0FBQ0EsT0FBSyxjQUFMLEdBQXNCO0FBQ3JCLGFBQVUsRUFEVyxFQUNQO0FBQ2QsWUFBUyxDQUZZLEVBRVQ7QUFDWixZQUFTLEVBSFksRUFHUjtBQUNiLGFBQVUsQ0FKVyxFQUlSO0FBQ2IsYUFBVSxDQUxXLEVBS1A7QUFDZCxlQUFZLElBTlMsRUFNSDtBQUNsQixlQUFZLElBUFMsRUFPSDtBQUNsQixZQUFTLEtBUlksRUFRTDtBQUNoQixVQUFPLEVBVGMsRUFTVjtBQUNYLFdBQVEsQ0FWYSxFQVVWO0FBQ1gsY0FBVyxLQVhVLEVBV0g7QUFDbEIsWUFBUyxHQVpZLEVBWVA7QUFDZCxlQUFZLElBYlMsQ0FhSjtBQWJJLEdBQXRCO0FBZUE7QUFDQSxPQUFLLE9BQUwsR0FBZSxLQUFLLFlBQUwsQ0FBa0IsT0FBbEIsRUFBMkIsS0FBSyxjQUFoQyxDQUFmO0FBNUI2QixpQkE2QjRDLEtBQUssT0E3QmpEO0FBQUEsTUE2QnJCLE9BN0JxQixZQTZCckIsT0E3QnFCO0FBQUEsTUE2QlosT0E3QlksWUE2QlosT0E3Qlk7QUFBQSxNQTZCSCxRQTdCRyxZQTZCSCxRQTdCRztBQUFBLE1BNkJPLFFBN0JQLFlBNkJPLFFBN0JQO0FBQUEsTUE2QmlCLFVB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WUFBUixDQUFxQixvQkFBckIsRUFBMkMsQ0FBM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFRLFlBQVIsQ0FBcUIsb0JBQXJCLEVBQTJDLFFBQTNDO0FBQ0E7QUFDQSxRQUFNLFNBQVMsS0FBSyxTQUFMLEVBQWY7QUFDQTtBQUNBLFFBQUksVUFBVSxRQUFPLE1BQVAseUNBQU8sTUFBUCxPQUFrQixRQUFoQyxFQUEwQztBQUN6QyxVQUFLLElBQUksUUFBVCxJQUFxQixNQUFyQixFQUE2QjtBQUM1QixjQUFRLEtBQVIsQ0FBYyxRQUFkLElBQTBCLE9BQU8sUUFBUCxDQUExQjtBQUNBO0FBQ0Q7QUFDRDtBQUNBLFFBQUksY0FBYyxRQUFPLFVBQVAseUNBQU8sVUFBUCxPQUFzQixRQUF4QyxFQUFrRDtBQUNqRCxVQUFLLElBQUksWUFBVCxJQUF5QixVQUF6QixFQUFxQztBQUNwQyxjQUFRLFlBQVIsQ0FBcUIsWUFBckIsRUFBbUMsV0FBVyxZQUFYLENBQW5DO0FBQ0E7QUFDRDtBQUNEO0FBQ0EsWUFBUSxXQUFSLENBQW9CLE9BQXBCO0FBQ0E7QUFDRDtBQUNBLE9BQUksQ0FBRSxVQUFOLEVBQWtCO0FBQ2pCLFlBQVEsU0FBUixDQUFrQixHQUFsQixDQUFzQixhQUF0QjtBQUNBO0FBQ0Q7Ozs7OztBQUlGLFFBQVEsUUFBUixHQUFtQixDQUFuQjs7a0JBRWUsTyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9cmV0dXJuIGV9KSgpIiwiLyoqXHJcbiAqIFNwZWNrbGUuanNcclxuICpcclxuICogQSBKYXZhU2NyaXB0IG1vZHVsZSB0aGF0IGFkZHMgcmVzcG9uc2l2ZSwgc3R5bGl6ZWQgXHJcbiAqIHNwZWNrbGVzIHRvIGFueSBlbGVtZW50OyB3aXRoIG5vIGRlcGVuZGVuY2llcy5cclxuICpcclxuICogQHBhY2thZ2Ugc3BlY2tsZVxyXG4gKiBAc2luY2UgICAwLjAuMVxyXG4gKi9cclxuY2xhc3MgU3BlY2tsZSB7XHJcblxyXG5cdC8qKlxyXG5cdCAqIENvbnN0cnVjdG9yLlxyXG5cdCAqXHJcblx0ICogQHNpbmNlICAwLjAuMVxyXG5cdCAqIEBwYXJhbSAge0VsZW1lbnR9ICBlbGVtZW50ICBUaGUgcGFzc2VkIGVsZW1lbnQgdG8gc3BlY2tsZS5cclxuXHQgKiBAcGFyYW0gIHtvYmp9ICAgICAgb3B0aW9ucyAgVGhlIG9wdGlvbnMgb2JqZWN0LlxyXG5cdCAqIEByZXR1cm4ge3ZvaWR9IFxyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuXHRcdC8vIGtlZXAgdHJhY2sgb2YgdGhpcyBpbnN0YW5jZSBudW1iZXIgZm9yIHVzZSBpbiBcclxuXHRcdC8vIGdyb3VwaW5nIHRoZSBzcGVja2xlcywgYW5kIHRoZSBgZGVzdHJveSgpYCBtZXRob2QuXHJcblx0XHR0aGlzLmluc3RhbmNlID0gU3BlY2tsZS5pbnN0YW5jZTtcclxuXHRcdC8vIGF1Z21lbnQgdGhlIGluc3RhbmNlIGNvdW50IG9uIHRoZSBjbGFzcywgbm90IHRoZSBpbnN0YW5jZS5cclxuXHRcdFNwZWNrbGUuaW5zdGFuY2UrKztcclxuXHRcdC8vIHRocm93IGVycm9yIGlmIGBlbGVtZW50YCBpcyBub3QgYSB2YWxpZCBIVE1MIGVsZW1lbnQuXHJcblx0XHRpZiAoISBlbGVtZW50IHx8ICEgKGVsZW1lbnQgaW5zdGFuY2VvZiBFbGVtZW50KSkge1xyXG5cdFx0XHR0aGlzLnRocm93RWxlbWVudEVycm9yKCk7XHJcblx0XHR9XHJcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdFx0Ly8gU2V0IHRoZSBkZWZhdWx0IG9wdGlvbnMuXHJcblx0XHR0aGlzLmRlZmF1bHRPcHRpb25zID0ge1xyXG5cdFx0XHRxdWFudGl0eTogNTYsIC8vIHF1YW50aXR5IG9mIHNwZWNrbGVzXHJcblx0XHRcdG1pblNpemU6IDQsIC8vIHNtYWxsZXN0IHNwZWNrbGUgKDErLCBsZXNzIHRoYW4gYG1heFNpemVgLCBweClcclxuXHRcdFx0bWF4U2l6ZTogNTYsIC8vIGxhcmdlc3Qgc3BlY2tsZSAoMSssIGdyZWF0ZXIgdGhhbiBgbWluU2l6ZWAsIHB4KVxyXG5cdFx0XHR0Yk9mZnNldDogOCwgLy8gdG9wL2JvdHRvbSBvZmZzZXQgKDArLCAlKVxyXG5cdFx0XHRsck9mZnNldDogOCwgIC8vIGxlZnQvcmlnaHQgb2Zmc2V0ICgwKywgJSlcclxuXHRcdFx0bWluT3BhY2l0eTogMTIuNSwgLy8gbWluaW11bSBvcGFjaXR5ICgxLTEwMClcclxuXHRcdFx0bWF4T3BhY2l0eTogODcuNSwgLy8gbWF4aW11bSBvcGFjaXR5ICgxLTEwMClcclxuXHRcdFx0aXNCb2tlaDogZmFsc2UsIC8vIGJva2VoIGVmZmVjdCAoYmx1ciBhcyBhIGZhY3RvciBvZiBkaXN0YW5jZSlcclxuXHRcdFx0Y29sb3I6ICcnLCAvLyBjb2xvciAoaGV4LCByZ2IsIGhzbCwga2V5d29yZCkuIElmIG5vbmUsIHRoZSBjb2xvcnMgd2lsbCBiZSByYW5kb21pemVkLlxyXG5cdFx0XHR6SW5kZXg6IDAsIC8vIHotaW5kZXggKGJva2VoOiB0aGUgc3RhcnRpbmcgei1pbmRleClcclxuXHRcdFx0aXNDcm9wcGVkOiBmYWxzZSwgLy8gYXBwbHkgYG92ZXJmbG93OiBoaWRkZW47YCB0byB0aGUgY29udGFpbmVyXHJcblx0XHRcdHRhZ05hbWU6ICdJJywgLy8gdGhlIFRhZyBOYW1lIHRoYXQgdGhlIHNwZWNrbGUgc2hvdWxkIGJlIHJlbmRlcmVkIGFzXHJcblx0XHRcdGF0dHJpYnV0ZXM6IG51bGwgLy8gYXR0cmlidXRlcyBvYmplY3QgYXMgYGtleTogdmFsdWVgIHBhaXJzXHJcblx0XHR9O1xyXG5cdFx0Ly8gUGFyc2UgYW5kIHNldCBvcHRpb25zLlxyXG5cdFx0dGhpcy5vcHRpb25zID0gdGhpcy5wYXJzZU9wdGlvbnMob3B0aW9ucywgdGhpcy5kZWZhdWx0T3B0aW9ucyk7XHJcblx0XHRjb25zdCB7IG1pblNpemUsIG1heFNpemUsIHRiT2Zmc2V0LCBsck9mZnNldCwgbWluT3BhY2l0eSwgbWF4T3BhY2l0eSB9ID0gdGhpcy5vcHRpb25zO1xyXG5cdFx0Ly8gdGhyb3cgZXJyb3IgaWYgYG1pblNpemVgIGlzIGxlc3MgdGhhbiAxLCBvciBncmVhdGVyIHRoYW4gYG1heFNpemVgLlxyXG5cdFx0aWYgKChtaW5TaXplIDwgMSkgfHwgKG1pblNpemUgPiBtYXhTaXplKSkge1xyXG5cdFx0XHR0aGlzLnRocm93T3B0aW9uc0Vycm9yKCdtaW5TaXplJyk7XHJcblx0XHR9XHJcblx0XHQvLyB0aHJvdyBlcnJvciBpZiBgbWF4U2l6ZWAgaXMgbGVzcyB0aGFuIDEsIG9yIGxlc3MgdGhhbiBgbWluU2l6ZWAuXHJcblx0XHRpZiAoKG1heFNpemUgPCAxKSB8fCAobWF4U2l6ZSA8IG1pblNpemUpKSB7XHJcblx0XHRcdHRoaXMudGhyb3dPcHRpb25zRXJyb3IoJ21heFNpemUnKTtcclxuXHRcdH1cclxuXHRcdC8vIHRocm93IGVycm9yIGlmIGB0Yk9mZnNldGAgaXMgbGVzcyB0aGFuIDAuXHJcblx0XHRpZiAodGJPZmZzZXQgPCAwKSB7XHJcblx0XHRcdHRoaXMudGhyb3dPcHRpb25zRXJyb3IoJ3RiT2Zmc2V0Jyk7XHJcblx0XHR9XHJcblx0XHQvLyB0aHJvdyBlcnJvciBpZiBgbHJPZmZzZXRgIGlzIGxlc3MgdGhhbiAwLlxyXG5cdFx0aWYgKGxyT2Zmc2V0IDwgMCkge1xyXG5cdFx0XHR0aGlzLnRocm93T3B0aW9uc0Vycm9yKCdsck9mZnNldCcpO1xyXG5cdFx0fVxyXG5cdFx0Ly8gdGhyb3cgZXJyb3IgaWYgYG1pbk9wYWNpdHlgIGlzIGxlc3MgdGhhbiAwIG9yIGdyZWF0ZXIgdGhhbiAxMDA7IG9yIGlmIGlzIGdyZWF0ZXIgdGhhbiBgbWF4T3BhY2l0eWAuXHJcblx0XHRpZiAoKG1pbk9wYWNpdHkgPCAwKSB8fCAobWluT3BhY2l0eSA+IDEwMCkgfHwgKG1pbk9wYWNpdHkgPiBtYXhPcGFjaXR5KSkge1xyXG5cdFx0XHR0aGlzLnRocm93T3B0aW9uc0Vycm9yKCdtaW5PcGFjaXR5Jyk7XHJcblx0XHR9XHJcblx0XHQvLyB0aHJvdyBlcnJvciBpZiBgbWF4T3BhY2l0eWAgaXMgbGVzcyB0aGFuIDAgb3IgZ3JlYXRlciB0aGFuIDEwMDsgb3IgaWYgaXMgbGVzcyB0aGFuIGBtaW5PcGFjaXR5YC5cclxuXHRcdGlmICgobWF4T3BhY2l0eSA8IDApIHx8IChtYXhPcGFjaXR5ID4gMTAwKSB8fCAobWF4T3BhY2l0eSA8IG1pbk9wYWNpdHkpKSB7XHJcblx0XHRcdHRoaXMudGhyb3dPcHRpb25zRXJyb3IoJ21heE9wYWNpdHknKTtcclxuXHRcdH1cclxuXHRcdC8vIFNldCB0aGUgZ2xvYmFsIHN0eWxlcy5cclxuXHRcdHRoaXMuZ2xvYmFsU3R5bGVzID0ge1xyXG5cdFx0XHRib3JkZXJSYWRpdXM6ICc1MCUnLCBcclxuXHRcdFx0ZGlzcGxheTogJ2Jsb2NrJywgXHJcblx0XHRcdHBvaW50ZXJFdmVudHM6ICdub25lJywgXHJcblx0XHRcdHBvc2l0aW9uOiAnYWJzb2x1dGUnLCBcclxuXHRcdH07XHJcblx0XHQvLyBTZXQgdGhlIHVwZ3JhZGVkIGNsYXNzLlxyXG5cdFx0dGhpcy51cGdyYWRlZENsYXNzID0gJ3NwZWNrbGUtLXVwZ3JhZGVkJztcclxuXHRcdC8vIFJlbmRlciBzcGVja2xlcy5cclxuXHRcdHRoaXMucmVuZGVyKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBQYXJzZSB0aGUgcGFzc2VkIG9wdGlvbnMgYWdhaW5zdCB0aGUgZGVmYXVsdHMuXHJcblx0ICogXHJcblx0ICogQHBhcmFtICB7b2JqfSAgb3B0aW9ucyAgICAgICAgIFRoZSBwYXNzZWQgaW4gdXNlciBvcHRpb25zIG9iamVjdC5cclxuXHQgKiBAcGFyYW0gIHtvYmp9ICBkZWZhdWx0T3B0aW9ucyAgVGhlIGRlZmF1bHQgb3B0aW9ucyBvYmplY3QuXHJcblx0ICogQHJldHVybiB7b2JqfSAgICAgICAgICAgICAgICAgIFRoZSBwYXJzZWQgb3B0aW9ucyBvYmplY3QuXHJcblx0ICovXHJcblx0cGFyc2VPcHRpb25zKG9wdGlvbnMsIGRlZmF1bHRPcHRpb25zKSB7XHJcblx0XHQvLyBpZiBubyBvcHRpb25zIGFyZSBwYXNzZWQsIGp1c3QgcmV0dXJuIHRoZSBkZWZhdWx0IG9wdGlvbnMuXHJcblx0XHRpZiAoISBvcHRpb25zIHx8IHR5cGVvZiBvcHRpb25zICE9PSAnb2JqZWN0Jykge1xyXG5cdFx0XHRyZXR1cm4gZGVmYXVsdE9wdGlvbnM7XHJcblx0XHR9XHJcblx0XHQvLyBpbml0IGVtcHR5IGBwYXJzZWRPcHRpb25zYCBvYmplY3QuXHJcblx0XHR2YXIgcGFyc2VkT3B0aW9ucyA9IHt9O1xyXG5cdFx0Ly8gbG9vcCBkZWZhdWx0IG9wdGlvbiBrZXlzIGFuZCBwYXJzZS4gSWYgdGhlIG9wdGlvbnMgXHJcblx0XHQvLyBvYmplY3QgaGFzIHRoaXMga2V5LCB1c2UgaXQ7IGVsc2UsIHVzZSB0aGUgZGVmYXVsdCBvcHRpb24uXHJcblx0XHRmb3IgKHZhciBrZXkgaW4gZGVmYXVsdE9wdGlvbnMpIHtcclxuXHRcdFx0Y29uc3QgdmFsdWUgPSBvcHRpb25zW2tleV07XHJcblx0XHRcdC8vIElmIHRoZSB2YWx1ZSBpcyBhIG51bWJlciwgc2V0IGl0IG5vIG1hdHRlciB3aGF0LlxyXG5cdFx0XHQvLyBUaGlzIHByZXZlbnRzIGlzc3VlcyB3aGVyZSBwYXNzaW5nIGAwYCBpcyByZWFkIGFzIFxyXG5cdFx0XHQvLyBubyBvcHRpb24gcGFzc2VkLCByZW5kZXJpbmcgdGhlIGRlZmF1bHQgaW5zdGVhZC5cclxuXHRcdFx0aWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcclxuXHRcdFx0XHRwYXJzZWRPcHRpb25zW2tleV0gPSB2YWx1ZTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRwYXJzZWRPcHRpb25zW2tleV0gPSB2YWx1ZSB8fCBkZWZhdWx0T3B0aW9uc1trZXldO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHQvLyByZXR1cm4gdGhlIHBhcnNlZCBvcHRpb25zLlxyXG5cdFx0cmV0dXJuIHBhcnNlZE9wdGlvbnM7XHJcblxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVGhyb3cgYW4gZWxlbWVudCBlcnJvci5cclxuXHQgKiBcclxuXHQgKiBAc2luY2UgIDAuMC4xXHJcblx0ICogQHJldHVybiB7RXJyb3J9ICBUaGUgZm9ybWF0dGVkIGVsZW1lbnQgZXJyb3IuXHJcblx0ICovXHJcblx0dGhyb3dFbGVtZW50RXJyb3IoKSB7XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IoXHJcblx0XHRcdCdTcGVja2xlLmpzXFxuJyArIFxyXG5cdFx0XHQnQSB2YWxpZCBIVE1MIEVsZW1lbnQgbXVzdCBiZSBwYXNzZWQgdG8gdGhlIGNvbnN0cnVjdG9yIGFzIHRoZSBmaXJzdCBhcmd1bWVudC4nXHJcblx0XHQpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVGhyb3cgYW4gZWxlbWVudCBlcnJvci5cclxuXHQgKiBcclxuXHQgKiBAc2luY2UgIDAuMC4xXHJcblx0ICogQHJldHVybiB7RXJyb3J9ICBUaGUgZm9ybWF0dGVkIGVsZW1lbnQgZXJyb3IuXHJcblx0ICovXHJcblx0dGhyb3dPcHRpb25zRXJyb3Ioa2V5KSB7XHJcblx0XHR2YXIgbWVzc2FnZSA9ICcnO1xyXG5cdFx0aWYgKGtleSA9PT0gJ21pblNpemUnKSB7XHJcblx0XHRcdG1lc3NhZ2UgPSAnVGhlIHZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIDEsIGFuZCBsZXNzIHRoYW4gYG1heFNpemVgLic7XHJcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ21heFNpemUnKSB7XHJcblx0XHRcdG1lc3NhZ2UgPSAnVGhlIHZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIDEsIGFuZCBncmVhdGVyIHRoYW4gYG1pblNpemVgLic7XHJcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ3RiT2Zmc2V0Jykge1xyXG5cdFx0XHRtZXNzYWdlID0gJ1RoZSB2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwLic7XHJcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ2xyT2Zmc2V0Jykge1xyXG5cdFx0XHRtZXNzYWdlID0gJ1RoZSB2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwLic7XHJcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ21pbk9wYWNpdHknKSB7XHJcblx0XHRcdG1lc3NhZ2UgPSAnVGhlIHZhbHVlIG11c3QgYmUgYmV0d2VlbiAxIGFuZCAxMDAsIGFuZCBsZXNzIHRoYW4gYG1heE9wYWNpdHlgLic7XHJcblx0XHR9IGVsc2UgaWYgKGtleSA9PT0gJ21heE9wYWNpdHknKSB7XHJcblx0XHRcdG1lc3NhZ2UgPSAnVGhlIHZhbHVlIG11c3QgYmUgYmV0d2VlbiAxIGFuZCAxMDAsIGFuZCBncmVhdGVyIHRoYW4gYG1pbk9wYWNpdHlgLic7XHJcblx0XHR9XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IoXHJcblx0XHRcdGBTcGVja2xlLmpzIFske2tleX1dXFxuYCArIG1lc3NhZ2VcclxuXHRcdCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBHZXQgYSByYW5kb20gaW50ZWdlciBiZXR3ZWVuIGEgcGFzc2VkIG1pbmltdW0gYW5kIG1heGltdW0uXHJcblx0ICogXHJcblx0ICogQHNpbmNlICAwLjAuMVxyXG5cdCAqIEBwYXJhbSAge2ludH0gIG1pbiAgVGhlIG1pbmltdW0gZm9yIHRoZSByZXR1cm5lZCBpbnRlZ2VyLlxyXG5cdCAqIEBwYXJhbSAge2ludH0gIG1heCAgVGhlIG1heGltdW0gZm9yIHRoZSByZXR1cm5lZCBpbnRlZ2VyLlxyXG5cdCAqIEByZXR1cm4ge2ludH0gICAgICAgVGhlIHJhbmRvbWl6ZWQgaW50ZWdlci5cclxuXHQgKi9cclxuXHRnZXRSYW5kb21JbnQobWluLCBtYXgpIHtcclxuXHRcdHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoKG1heCAtIG1pbikgKyAxKSArIG1pbik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBHZXQgYSByYW5kb20gaGV4IGNvbG9yLlxyXG5cdCAqIFxyXG5cdCAqIEBzaW5jZSAgMC4wLjFcclxuXHQgKiBAcmV0dXJuIHtzdHJpbmd9ICBBIHJhbmRvbSBoZXggY29sb3IuXHJcblx0ICovXHJcblx0Z2V0UmFuZG9tSGV4KCkge1xyXG5cdFx0cmV0dXJuIGAjJHsoJzAwMDAwMCcgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zbGljZSgyLCA4KSkuc2xpY2UoLTYpLnRvVXBwZXJDYXNlKCl9YDtcclxuXHR9XHJcblxyXG5cdGdldFN0eWxlcygpIHtcclxuXHRcdGNvbnN0IHsgZ2xvYmFsU3R5bGVzLCBvcHRpb25zIH0gPSB0aGlzO1xyXG5cdFx0Y29uc3QgeyBtaW5TaXplLCBtYXhTaXplLCB0Yk9mZnNldCwgbHJPZmZzZXQsIG1pbk9wYWNpdHksIG1heE9wYWNpdHksIGNvbG9yLCBpc0Jva2VoLCB6SW5kZXggfSA9IG9wdGlvbnM7XHJcblx0XHQvLyBzaXplXHJcblx0XHRjb25zdCBzaXplID0gdGhpcy5nZXRSYW5kb21JbnQobWluU2l6ZSwgbWF4U2l6ZSk7XHJcblx0XHRjb25zdCBjZW50ZXIgPSAoc2l6ZSAvIDIpO1xyXG5cdFx0Ly8gY29sb3JcclxuXHRcdGNvbnN0IHJlbmRlckNvbG9yID0gY29sb3IgfHwgdGhpcy5nZXRSYW5kb21IZXgoKTtcclxuXHRcdC8vIENyZWF0ZSB0aGUgc3R5bGVzIG9iamVjdC5cclxuXHRcdHJldHVybiBPYmplY3QuYXNzaWduKGdsb2JhbFN0eWxlcywge1xyXG5cdFx0XHRiYWNrZ3JvdW5kQ29sb3I6IHJlbmRlckNvbG9yLCBcclxuXHRcdFx0Ym94U2hhZG93OiBpc0Jva2VoID8gYDAgMCAkeyhzaXplIC8gMyl9cHggJHsoc2l6ZSAvIDMpfXB4ICR7cmVuZGVyQ29sb3J9YCA6ICcnLCBcclxuXHRcdFx0aGVpZ2h0OiBgJHtzaXplfXB4YCwgXHJcblx0XHRcdGxlZnQ6IGBjYWxjKCR7dGhpcy5nZXRSYW5kb21JbnQoMCAtIGxyT2Zmc2V0LCAxMDAgKyBsck9mZnNldCl9JSAtICR7Y2VudGVyfXB4KWAsIFxyXG5cdFx0XHRvcGFjaXR5OiAodGhpcy5nZXRSYW5kb21JbnQobWluT3BhY2l0eSwgbWF4T3BhY2l0eSkgKiAwLjAxKSwgXHJcblx0XHRcdHRvcDogYGNhbGMoJHt0aGlzLmdldFJhbmRvbUludCgwIC0gdGJPZmZzZXQsIDEwMCArIHRiT2Zmc2V0KX0lIC0gJHtjZW50ZXJ9cHgpYCwgXHJcblx0XHRcdHdpZHRoOiBgJHtzaXplfXB4YCwgXHJcblx0XHRcdHpJbmRleDogekluZGV4LCBcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogRGVzdHJveSBTcGVja2xlLlxyXG5cdCAqIFxyXG5cdCAqIEByZXR1cm4ge3ZvaWR9IFxyXG5cdCAqL1xyXG5cdGRlc3Ryb3koKSB7XHJcblx0XHRjb25zdCB7IGVsZW1lbnQsIGluc3RhbmNlLCB1cGdyYWRlZENsYXNzIH0gPSB0aGlzO1xyXG5cdFx0Ly8gZGVzdHJveSB0aGUgc3BlY2tsZXMgcmVsYXRlZCB0byB0aGlzIGluc3RhbmNlLlxyXG5cdFx0Y29uc3Qgc3BlY2tsZXMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYFtkYXRhLXNwZWNrbGUtZ3JvdXA9XCIke2luc3RhbmNlfVwiXWApO1xyXG5cdFx0aWYgKHNwZWNrbGVzICYmIChzcGVja2xlcy5sZW5ndGggPiAwKSkge1xyXG5cdFx0XHRzcGVja2xlcy5mb3JFYWNoKChzcGVja2xlLCBpKSA9PiB7XHJcblx0XHRcdFx0ZWxlbWVudC5yZW1vdmVDaGlsZChzcGVja2xlKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0XHQvLyByZW1vdmUgdGhpcyBpbnN0YW5jZSBmcm9tIHRoZSBgZGF0YS1zcGVja2xlLWdyb3Vwc2AgXHJcblx0XHQvLyBhdHRyaWJ1dGUgb24gdGhlIGNvbnRhaW5lciBlbGVtZW50LiBJZiBub25lIGFyZSBsZWZ0IGFmdGVyXHJcblx0XHQvLyByZW1vdmFsLCByZW1vdmUgdGhlIGF0dHJpYnV0ZSBhbGx0b2dldGhlci5cclxuXHRcdGNvbnN0IGdyb3VwcyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXNwZWNrbGUtZ3JvdXBzJykgfHwgJyc7XHJcblx0XHQvLyBpbml0aWFsaXplIHRoZSBgY2xlYW5FbGVtZW50YCB2YXIgYXMgZmFsc2UuXHJcblx0XHRsZXQgY2xlYW5FbGVtZW50ID0gZmFsc2U7XHJcblx0XHRpZiAoZ3JvdXBzKSB7XHJcblx0XHRcdC8vIHNwbGl0IHRoZSBncm91cHMgdmFsdWUgYnkgYCxgIGFuZCBleHBsb2RlIGludG8gYW4gYXJyYXkuXHJcblx0XHRcdGxldCBuZXdHcm91cHMgPSBncm91cHMuc3BsaXQoJywnKTtcclxuXHRcdFx0Ly8gVXNpbmcgYHNwbGljZSgpYCwgcmVtb3ZlIHRoZSBpbmRleCBvZiB0aGlzIGluc3RhbmNlIGZyb21cclxuXHRcdFx0Ly8gdGhlIGBuZXdHcm91cHNgIGFycmF5LiBOb3RlOiB0aGlzIHJldHVybnMgdGhlIHJlbW92ZWQgbm9kZSwgXHJcblx0XHRcdC8vIG5vdCB0aGUgbmV3IGFycmF5LlxyXG5cdFx0XHRuZXdHcm91cHMuc3BsaWNlKG5ld0dyb3Vwcy5pbmRleE9mKGluc3RhbmNlLnRvU3RyaW5nKCkpLCAxKTtcclxuXHRcdFx0Ly8gaWYgdGhlcmUgYXJlIGFueSBncm91cHMgbGVmdCBhZnRlciB0aGUgcmVtb3ZhbCwgXHJcblx0XHRcdC8vIHNldCB0aGUgYGRhdGEtc3BlY2tsZS1ncm91cHNgIGF0dHJpYnV0ZSB0byB0aGUgXHJcblx0XHRcdC8vIG5ldyBpdGVtcyBhcyBDU1YuIElmIHRoZXJlIGFyZSBubyBpdGVtcyBsZWZ0LCByZW1vdmUgXHJcblx0XHRcdC8vIHRoZSBhdHRyaWJ1dGUgYW5kIHNldCBgY2xlYW5FbGVtZW50YCB0byBgdHJ1ZWAuXHJcblx0XHRcdGlmIChuZXdHcm91cHMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXNwZWNrbGUtZ3JvdXBzJywgbmV3R3JvdXBzLmpvaW4oJywnKSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc3BlY2tsZS1ncm91cHMnKTtcclxuXHRcdFx0XHRjbGVhbkVsZW1lbnQgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHQvLyBmdWxseSBjbGVhbiB0aGUgY29udGFpbmVyIGVsZW1lbnQsIGJ1dCBvbmx5IGlmIG5vIHNwZWNrbGUgXHJcblx0XHQvLyBncm91cHMgYXJlIGxlZnQgb24gdGhlIGNvbnRhaW5lciBlbGVtZW50IGJ5IHRoaXMgcG9pbnQuXHJcblx0XHRpZiAoY2xlYW5FbGVtZW50KSB7XHJcblx0XHRcdC8vIGlmIHRoZSBDU1MgYHBvc2l0aW9uYCBvZiB0aGUgY29udGFpbmVyIGVsZW1lbnQgd2FzIG1vZGlmaWVkXHJcblx0XHRcdC8vIGJ5IHRoaXMgY2xhc3MsIGl0IHdpbGwgaGF2ZSBhZGRlZCBhIGBkYXRhLXNwZWNrbGUtcG9zaXRpb24tbW9kYCBcclxuXHRcdFx0Ly8gYXR0cmlidXRlIHNldCB0byBgdHJ1ZWAgb3IgdGhlIGVsZW1lbnQncyBleHBsaWNpdCBDU1MgYHBvc2l0aW9uYCBcclxuXHRcdFx0Ly8gdmFsdWUgaWYgdGhlcmUgd2FzIG9uZSBvbiB0aGUgZWxlbWVudCBpdHNlbGYgcHJpb3IgdG8gdGhlIFxyXG5cdFx0XHQvLyBmaXJzdCBpbml0aWFsaXphdGlvbi5cclxuXHRcdFx0Y29uc3QgcG9zaXRpb25Nb2QgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zcGVja2xlLXBvc2l0aW9uLW1vZCcpO1xyXG5cdFx0XHRpZiAocG9zaXRpb25Nb2QpIHtcclxuXHRcdFx0XHRlbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gKHBvc2l0aW9uTW9kID09PSAndHJ1ZScpID8gbnVsbCA6IHBvc2l0aW9uTW9kO1xyXG5cdFx0XHRcdGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXNwZWNrbGUtcG9zaXRpb24tbW9kJyk7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gcmVtb3ZlIHRoZSB1cGdyYWRlZCBjbGFzcy5cclxuXHRcdFx0ZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHVwZ3JhZGVkQ2xhc3MpO1xyXG5cdFx0XHQvLyBSZW1vdmUgdGhlIG92ZXJmbG93IG1vZC4gaWYgdGhlIENTUyBgb3ZlcmZsb3dgIG9mIHRoZSBjb250YWluZXIgXHJcblx0XHRcdC8vIGVsZW1lbnQgd2FzIG1vZGlmaWVkIGJ5IHRoaXMgY2xhc3MsIGl0IHdpbGwgaGF2ZSBhZGRlZCBhIFxyXG5cdFx0XHQvLyBgZGF0YS1zcGVja2xlLW92ZXJmbG93LW1vZGAgYXR0cmlidXRlIHNldCB0byBgdHJ1ZWAgb3IgdGhlIFxyXG5cdFx0XHQvLyBlbGVtZW50J3MgZXhwbGljaXQgQ1NTIGBvdmVyZmxvd2AgdmFsdWUgaWYgdGhlcmUgd2FzIG9uZSBcclxuXHRcdFx0Ly8gb24gdGhlIGVsZW1lbnQgaXRzZWxmIHByaW9yIHRvIHRoZSBmaXJzdCBpbml0aWFsaXphdGlvbi5cclxuXHRcdFx0Y29uc3Qgb3ZlcmZsb3dNb2QgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zcGVja2xlLW92ZXJmbG93LW1vZCcpO1xyXG5cdFx0XHRpZiAob3ZlcmZsb3dNb2QpIHtcclxuXHRcdFx0XHRlbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gKG92ZXJmbG93TW9kID09PSAndHJ1ZScpID8gbnVsbCA6IG92ZXJmbG93TW9kO1xyXG5cdFx0XHRcdGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXNwZWNrbGUtb3ZlcmZsb3ctbW9kJyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIERlc3Ryb3kgYW5kIHJlcmVuZGVyIHRoZSBzcGVja2xlcyBhY2NvcmRpbmdcclxuXHQgKiB0byB0aGUgc2FtZSBvcHRpb25zLiBTaW1wbHkgcnVucyB0aGUgYGRlc3Ryb3koKWBcclxuXHQgKiBtZXRob2QgZm9sbG93ZWQgYnkgdGhlIGByZW5kZXIoKWAgbWV0aG9kIGFnYWluLlxyXG5cdCAqIFxyXG5cdCAqIEByZXR1cm4ge3ZvaWR9IFxyXG5cdCAqL1xyXG5cdHJlcmVuZGVyKCkge1xyXG5cdFx0dGhpcy5kZXN0cm95KCk7XHJcblx0XHR0aGlzLnJlbmRlcigpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmVuZGVyIHRoZSBzcGVja2xlcy5cclxuXHQgKiBcclxuXHQgKiBAc2luY2UgIDAuMC4xXHJcblx0ICogQHBhcmFtICB7RWxlbWVudH0gIGVsZW1lbnQgIFRoZSBjb250YWluZXIgZWxlbWVudCB0byBzcGVja2xlLlxyXG5cdCAqIEByZXR1cm4ge3ZvaWR9IFxyXG5cdCAqL1xyXG5cdHJlbmRlcigpIHtcclxuXHRcdGNvbnN0IHsgZWxlbWVudCwgaW5zdGFuY2UsIG9wdGlvbnMsIHVwZ3JhZGVkQ2xhc3MgfSA9IHRoaXM7XHJcblx0XHRjb25zdCB7IHF1YW50aXR5LCBpc0Nyb3BwZWQsIHRhZ05hbWUsIGF0dHJpYnV0ZXMgfSA9IG9wdGlvbnM7XHJcblx0XHRjb25zdCB7IHBvc2l0aW9uLCBvdmVyZmxvdyB9ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XHJcblx0XHRjb25zdCBpc1VwZ3JhZGVkID0gZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnModXBncmFkZWRDbGFzcyk7XHJcblx0XHQvLyBTZXQgdGhlIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MgYXMgYGRhdGEtc3BlY2tsZS1ncm91cGAgXHJcblx0XHQvLyBpbmNhc2UgaXQgbmVlZHMgdG8gYmUgYWNjZXNzZWQgYnkgb3RoZXIgc2NyaXB0cy4gR2V0IHRoZSB2YWx1ZSBcclxuXHRcdC8vIGFuZCBhcHBlbmQgcmF0aGVyIHRoYW4gb3ZlcndyaXRpbmcgYXMgdGhpcyB2YWx1ZSBjYW4gYmUgYSBDU1YgXHJcblx0XHQvLyBsaXN0IG9mIHNwZWNrbGUgZ3JvdXBzLlxyXG5cdFx0Y29uc3Qgb2xkR3JvdXBzID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc3BlY2tsZS1ncm91cHMnKSB8fCAnJztcclxuXHRcdGNvbnN0IG5ld0dyb3VwcyA9IG9sZEdyb3VwcyA/IFtvbGRHcm91cHMsIGluc3RhbmNlXS5qb2luKCcsJykgOiBpbnN0YW5jZTtcclxuXHRcdGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXNwZWNrbGUtZ3JvdXBzJywgbmV3R3JvdXBzKTtcclxuXHRcdC8vIG9ubHkgYWRkIHJlbGF0aXZlIHBvc2l0aW9uaW5nIHRvIHRoZSBjb250YWluZXIgZWxlbWVudCBpZiBcclxuXHRcdC8vIGl0IGlzIG5vdCBhbHJlYWR5IGByZWxhdGl2ZWAsIGBmaXhlZGAsIG9yIGBhYnNvbHV0ZWAuXHJcblx0XHRpZiAoISBpc1VwZ3JhZGVkICYmIChbJ3JlbGF0aXZlLCBhYnNvbHV0ZSwgZml4ZWQnXS5pbmRleE9mKHBvc2l0aW9uKSA9PT0gLTEpKSB7XHJcblx0XHRcdC8vIG9uIHRoZSBjb250YWluZXIgZWxlbWVudCwgc2F2ZSB0aGUgZmFjdCB0aGF0IHRoZSBDU1MgYHBvc2l0aW9uYCBoYXMgXHJcblx0XHRcdC8vIGJlZW4gbW9kaWZpZWQgYXMgYSBgZGF0YS1zcGVja2xlLXBvc2l0aW9uLW1vZGAgYXR0cmlidXRlIHNldCB0byBgdHJ1ZWAgXHJcblx0XHRcdC8vIG9yIHRoZSBleHBsaWNpdCBgcG9zaXRpb25gIHZhbHVlIGlmIHRoZXJlIGlzIG9uZS5cclxuXHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3BlY2tsZS1wb3NpdGlvbi1tb2QnLCBlbGVtZW50LnN0eWxlLnBvc2l0aW9uIHx8IHRydWUpO1xyXG5cdFx0XHQvLyBzZXQgdGhlIENTUyBgcG9zaXRpb25gdmFsdWUgdG8gYHJlbGF0aXZlYCBzbyB0aGF0IHRoZSBzcGVja2xlcyBcclxuXHRcdFx0Ly8gKHdoaWNoIGFyZSBwb3NpdGlvbmVkIGFic29sdXRlKSBrbm93IHdoZXJlIHRvIGxpdmUuXHJcblx0XHRcdGVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xyXG5cdFx0fVxyXG5cdFx0Ly8gQWRkIGBvdmVyZmxvdzogaGlkZGVuO2AgdG8gZWxlbWVudCBpZiBgaXNDcm9wcGVkYCBpcyBgdHJ1ZWAsIGlmXHJcblx0XHQvLyBvdmVyZmxvd3MgYXJlIG5vdCBhbHJlYWR5IGhpZGRlbiBvbiB0aGUgY29udGFpbmVyIGVsZW1lbnQuXHJcblx0XHRpZiAoISBpc1VwZ3JhZGVkICYmIGlzQ3JvcHBlZCAmJiAoWydoaWRkZW4nXS5pbmRleE9mKG92ZXJmbG93KSA9PT0gLTEpKSB7XHJcblx0XHRcdGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXNwZWNrbGUtb3ZlcmZsb3ctbW9kJywgZWxlbWVudC5zdHlsZS5vdmVyZmxvdyB8fCB0cnVlKTtcclxuXHRcdFx0ZWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xyXG5cdFx0fVxyXG5cdFx0Ly8gcmVuZGVyIHNwZWNrbGVzIGFjY29yZGluZyB0byBxdWFudGl0eS5cclxuXHRcdGZvciAodmFyIGkgPSAxOyBpIDw9IHF1YW50aXR5OyBpKyspIHtcclxuXHRcdFx0Ly8gQ3JlYXRlIHNwZWNrbGUgZWxlbWVudCBhY2NvcmRpbmcgdG8gdGhlIGB0YWdOYW1lYCBvcHRpb24uXHJcblx0XHRcdGNvbnN0IHNwZWNrbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZ05hbWUpO1xyXG5cdFx0XHQvLyBTZXQgdGhlIGluZGV4IG9mIHRoaXMgc3BlY2tsZSBhcyBgZGF0YS1zcGVja2xlLWluZGV4YCBcclxuXHRcdFx0Ly8gaW5jYXNlIGl0IG5lZWRzIHRvIGJlIGFjY2Vzc2VkIGJ5IG90aGVyIHNjcmlwdHMuXHJcblx0XHRcdHNwZWNrbGUuc2V0QXR0cmlidXRlKCdkYXRhLXNwZWNrbGUtaW5kZXgnLCBpKTtcclxuXHRcdFx0Ly8gU2V0IHRoZSBzcGVja2xlIGdyb3VwIGFzIGBkYXRhLXNwZWNrbGUtZ3JvdXBgIGF0dHJpYnV0ZVxyXG5cdFx0XHQvLyBpbmNhc2UgaXQgbmVlZHMgdG8gYmUgYWNjZXNzZWQgYnkgb3RoZXIgc2NyaXB0cywgYW5kXHJcblx0XHRcdC8vIGZvciB1c2UgaW4gdGhlIGBkZXN0cm95KClgIG1ldGhvZC5cclxuXHRcdFx0c3BlY2tsZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3BlY2tsZS1ncm91cCcsIGluc3RhbmNlKTtcclxuXHRcdFx0Ly8gR2V0IHNwZWNrbGUgc3R5bGVzLlxyXG5cdFx0XHRjb25zdCBzdHlsZXMgPSB0aGlzLmdldFN0eWxlcygpO1xyXG5cdFx0XHQvLyBsb29wIG92ZXIgdGhlIHNwZWNrbGUgc3R5bGUgb2JqZWN0IGtleXMgYW5kIGFwcGx5IHRoZSBzdHlsZXMuXHJcblx0XHRcdGlmIChzdHlsZXMgJiYgdHlwZW9mIHN0eWxlcyA9PT0gJ29iamVjdCcpIHtcclxuXHRcdFx0XHRmb3IgKHZhciBzdHlsZUtleSBpbiBzdHlsZXMpIHtcclxuXHRcdFx0XHRcdHNwZWNrbGUuc3R5bGVbc3R5bGVLZXldID0gc3R5bGVzW3N0eWxlS2V5XTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gQWRkIHRoZSBjdXN0b20gYXR0cmlidXRlcyB0byB0aGUgc3BlY2tsZS5cclxuXHRcdFx0aWYgKGF0dHJpYnV0ZXMgJiYgdHlwZW9mIGF0dHJpYnV0ZXMgPT09ICdvYmplY3QnKSB7XHJcblx0XHRcdFx0Zm9yICh2YXIgYXR0cmlidXRlS2V5IGluIGF0dHJpYnV0ZXMpIHtcclxuXHRcdFx0XHRcdHNwZWNrbGUuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZUtleSwgYXR0cmlidXRlc1thdHRyaWJ1dGVLZXldKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gQXBwZW5kIHRoZSBzcGVja2xlIHRvIHRoZSBjb250YWluZXIgZWxlbWVudC5cclxuXHRcdFx0ZWxlbWVudC5hcHBlbmRDaGlsZChzcGVja2xlKTtcclxuXHRcdH1cclxuXHRcdC8vIGFkZCB0aGUgdXBncmFkZWQgY2xhc3MuXHJcblx0XHRpZiAoISBpc1VwZ3JhZGVkKSB7XHJcblx0XHRcdGVsZW1lbnQuY2xhc3NMaXN0LmFkZCh1cGdyYWRlZENsYXNzKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG59XHJcblxyXG5TcGVja2xlLmluc3RhbmNlID0gMTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNwZWNrbGU7Il19"}